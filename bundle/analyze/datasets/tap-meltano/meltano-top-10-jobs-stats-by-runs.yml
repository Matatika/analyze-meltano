version: datasets/v0.2
source: tap-meltano
title: Top 10 Meltano Jobs Stats by Runs
questions: What are the stats of my top 10 Meltano jobs by runs?
description: |-
  Top 10 Meltano jobs with stats, by runs.
  
  #meltano
metadata: |-
  {
    "name": "mdj",
    "label": "Top 10 Meltano Jobs Stats by Runs", 
    "related_table": {
      "columns": [
        {"name": "job_id", "label": "Job Id", "description": "Job Id"}, 
        {"name": "total_jobs", "label": "Total Jobs", "description": "Total Jobs"},
        {"name": "successful_jobs", "label": "Successful Jobs", "description": "Successful Jobs"},
        {"name": "failed_jobs", "label": "Failed Jobs", "description": "Failed Jobs"},
        {"name": "avg_duration", "label": "Average Job Duration", "description": "Average Job Duration"},
        {"name": "total_duration", "label": "Total Job Duration", "description": "Total Job Duration"}
      ]
    }
  }
visualisation: '{"google-chart": {"chartType": "Table"}}'
query: |-
  SELECT 
    job_id "mdj.job_id"
    , SUM(total_jobs) "mdj.total_jobs"
    , SUM(total_successful_jobs) "mdj.successful_jobs"
    , SUM(total_failed_jobs) "mdj.failed_jobs"
    , TO_CHAR(DATE_PART('epoch', DATE_TRUNC('second', AVG(average_job_duration))) * INTERVAL '1 seconds', 'HH24:MM:SS') "mdj.avg_duration"
    , TO_CHAR(DATE_PART('epoch', SUM(total_job_duration)) * INTERVAL '1 seconds', 'HH24:MM:SS') "mdj.total_duration"
  FROM meltano_daily_jobs_by_job_id mdj 
  GROUP BY job_id
  ORDER BY "mdj.total_jobs" DESC
  LIMIT 10